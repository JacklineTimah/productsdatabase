"use strict";var jwt=require("jsonwebtoken"),config=require("../config/env/index"),_require=require("../config/database.config"),runQuery=_require.runQuery,_require2=require("../queries/user"),findUserByEmail=_require2.findUserByEmail,verifyToken=function(r,t,u){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.headers.authorization,e.prev=1,n){e.next=4;break}return e.abrupt("return",t.status(400).json({status:"error",code:400,message:"Please supply token",data:null}));case 4:if(a=jwt.verify(n,config.JWT_SECRET_KEY)){e.next=7;break}return e.abrupt("return",t.status(400).json({status:"error",code:401,message:"You are not authorized to make this request!",data:null}));case 7:return r.user=a,e.abrupt("return",u());case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",u(e.t0));case 14:case"end":return e.stop()}},null,null,[[1,11]])};module.exports={verifyToken:verifyToken};
//# sourceMappingURL=auth.middleware.min.js.map
