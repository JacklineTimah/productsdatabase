{"version":3,"sources":["auth.middleware.js"],"names":["jwt","require","config","runQuery","findUserByEmail","verifyToken","req","res","next","token","headers","status","json","code","message","data","user","verify","JWT_SECRET_KEY","module","exports"],"mappings":";;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AACA,IAAMC,MAAM,GAAGD,OAAO,CAAC,qBAAD,CAAtB;;eACqBA,OAAO,CAAC,2BAAD,C;IAApBE,Q,YAAAA,Q;;gBACoBF,OAAO,CAAC,iBAAD,C;IAA3BG,e,aAAAA,e;;AAER,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AACVC,UAAAA,KADU,GACFH,GAAG,CAACI,OAAJ,CAAY,eAAZ,CADE;AAAA;;AAAA,cAGPD,KAHO;AAAA;AAAA;AAAA;;AAAA,2CAIDF,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBD,YAAAA,MAAM,EAAE,OADgB;AAExBE,YAAAA,IAAI,EAAE,GAFkB;AAGxBC,YAAAA,OAAO,EAAE,qBAHe;AAIxBC,YAAAA,IAAI,EAAE;AAJkB,WAArB,CAJC;;AAAA;AAYNC,UAAAA,IAZM,GAYChB,GAAG,CAACiB,MAAJ,CAAWR,KAAX,EAAkBP,MAAM,CAACgB,cAAzB,CAZD;;AAAA,cAaPF,IAbO;AAAA;AAAA;AAAA;;AAAA,2CAcDT,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,YAAAA,MAAM,EAAE,OADkB;AAE1BE,YAAAA,IAAI,EAAE,GAFoB;AAG1BC,YAAAA,OAAO,EAAE,8CAHiB;AAI1BC,YAAAA,IAAI,EAAE;AAJoB,WAArB,CAdC;;AAAA;AAqBVT,UAAAA,GAAG,CAACU,IAAJ,GAAWA,IAAX;AArBU,2CAsBHR,IAAI,EAtBD;;AAAA;AAAA;AAAA;AAAA,2CAwBHA,IAAI,aAxBD;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAApB;;AA6BAW,MAAM,CAACC,OAAP,GAAkB;AACdf,EAAAA,WAAW,EAAXA;AADc,CAAlB","sourcesContent":["const jwt = require('jsonwebtoken');\r\nconst config = require('../config/env/index');\r\nconst { runQuery } = require('../config/database.config')\r\nconst { findUserByEmail } = require('../queries/user');\r\n\r\nconst verifyToken = async (req, res, next) => {\r\n    const token = req.headers['authorization'];\r\n    try {\r\n        if (!token) {\r\n            return res.status(400).json({\r\n                status: 'error',\r\n                code: 400,\r\n                message: 'Please supply token',\r\n                data: null\r\n            });\r\n        }\r\n\r\n        const user = jwt.verify(token, config.JWT_SECRET_KEY);\r\n        if (!user) {\r\n            return res.status(400).json({\r\n              status: 'error',\r\n              code: 401,\r\n              message: 'You are not authorized to make this request!',\r\n              data: null,\r\n            });\r\n          }\r\n          req.user = user;\r\n          return next();\r\n        } catch (error) {\r\n          return next(error);\r\n        }\r\n      };\r\n      \r\n\r\nmodule.exports =  {\r\n    verifyToken\r\n}"],"file":"auth.middleware.dev.js"}